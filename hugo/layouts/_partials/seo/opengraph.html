{{/*
  OpenGraph meta tags - enables rich previews on Facebook, LinkedIn, etc.
  Falls back to site defaults when page-specific values are missing.
*/}}
{{- $title := .Title -}}
{{- $description := .Description | default .Site.Params.description -}}
{{- $url := .Permalink -}}
{{- $type := cond .IsHome "website" "article" -}}

{{- $image := "" -}}
{{- with .Params.images -}}
  {{- $image = index . 0 -}}
{{- else -}}
  {{- with .Site.Params.images -}}
    {{- $image = index . 0 -}}
  {{- end -}}
{{- end -}}

<meta property="og:title" content="{{ $title }}" />
<meta property="og:description" content="{{ $description }}" />
<meta property="og:url" content="{{ $url }}" />
<meta property="og:type" content="{{ $type }}" />
<meta property="og:site_name" content="{{ .Site.Title }}" />
<meta property="og:locale" content="{{ .Site.LanguageCode | default "en_US" | replaceRE "-" "_" }}" />

{{- with $image }}
  {{- $imageURL := . -}}
  {{- $imageResource := "" -}}
  {{- if not (strings.HasPrefix . "http") -}}
    {{- with resources.Get . -}}
      {{- $imageURL = .Permalink -}}
      {{- $imageResource = . -}}
    {{- end -}}
  {{- end -}}
  <meta property="og:image" content="{{ $imageURL }}" />
  {{- /* Use configured dimensions or introspect from resource */ -}}
  {{- $width := $.Site.Params.imageWidth | default 1200 -}}
  {{- $height := $.Site.Params.imageHeight | default 630 -}}
  {{- with $imageResource -}}
    {{- $width = .Width -}}
    {{- $height = .Height -}}
  {{- end -}}
  <meta property="og:image:width" content="{{ $width }}" />
  <meta property="og:image:height" content="{{ $height }}" />
  {{- with $.Params.imageAlt | default $.Site.Params.imageAlt | default $title }}
    <meta property="og:image:alt" content="{{ . }}" />
  {{- end }}
{{- end }}

{{- if not .IsHome }}
  {{- with .PublishDate }}
    <meta property="article:published_time" content="{{ .Format "2006-01-02T15:04:05Z07:00" }}" />
  {{- end }}
  {{- with .Lastmod }}
    <meta property="article:modified_time" content="{{ .Format "2006-01-02T15:04:05Z07:00" }}" />
  {{- end }}
  {{- with .Params.author | default .Site.Params.author.name }}
    <meta property="article:author" content="{{ . }}" />
  {{- end }}
{{- end }}
